---
title: "General Trends and Descriptive Analysis"
author: "&copy; Hector Mathonsi"
date: 2024-10-19
output:
html_notebook:
theme: flatly
highlight: tango
toc: true
toc_float: true
---

-----

# Abstract

This report explores the relationships between various factors influencing student performance, using exploratory data analysis (EDA) to identify key trends and correlations. The analysis focuses on variables such as study habits, access to resources, parental involvement, and environmental factors, and how they impact final exam scores. Insights gained from the data will inform recommendations aimed at improving academic outcomes for students.

# Data Source

The dataset was sourced from Kaggle under the CC0 1.0 universal "No Copyright" license. We are free to copy, modify, distribute and perform the work, even for commercial purposes, all without asking permission. Learn more about this license here [here](https://creativecommons.org/publicdomain/zero/1.0/).

URL for data in Kaggle: [Student Performance Factors Dataset](https://www.kaggle.com/datasets/lainguyn123/student-performance-factors)

# Import and View Data

```{r}
student_data <- read.csv('../data/StudentPerformanceFactors.csv', header = TRUE)
student_data    # Display the dataset
sample_fraction <- 0.3
```

### Summary Statistics

```{r}
# Summary statistics for all variables
summary(student_data)   # Summary statistics for all variables
head(student_data)      # Display the first few rows of the dataset
str(student_data)       # Structure of the dataset
sum(is.na(student_data))    # Check for missing values
```

# Data Cleaning
## Missing Values
We now check whether the dataset contains any missing values and remove them if necessary.

```{r}
# Check missing values in each column
colSums(is.na(student_data))
```

We can see that there are no missing values in the dataset.

We now check the unique values in each categorical column to identify any inconsistencies.

```{r}
# Unique values in each categorical column
lapply(student_data[, sapply(student_data, is.character)], unique)
```

From the results above we can Teacher_Quality, Parental_Education_Level and Distance_from_Home have missing values. We will now investigate further to see exactly what these missing values are.

```{r}
# Check for missing values in Teacher_Quality
teacher_quality_missing <- student_data[student_data$Teacher_Quality == "",]
teacher_quality_missing
nrow(teacher_quality_missing)
```

We can see that only 78 rows have missing values in the Teacher_Quality column. We will now investigate the Parental_Education_Level column.

```{r}
# Check for missing values in Parental_Education_Level
parental_education_level_missing <- student_data[student_data$Parental_Education_Level == "",]
parental_education_level_missing
nrow(parental_education_level_missing)
```

We can see that 90 rows have missing values in the Parental_Education_Level column. We will now investigate the Distance_from_Home column.

```{r}
# Check for missing values in Distance_from_Home
distance_from_home_missing <- student_data[student_data$Distance_from_Home == "",]
distance_from_home_missing
nrow(distance_from_home_missing)
```

We can see that 67 rows have missing values in the Distance_from_Home column. All the missing values combined make up less than 10% of the dataset. We will remove these rows from the dataset.

```{r}
# Remove rows with missing values
student_data <- subset(student_data, Teacher_Quality != "" & Parental_Education_Level != "" & Distance_from_Home != "")

# Check for missing values
lapply(student_data[, sapply(student_data, is.character)], unique)
```

## Outliers

We now investigate the dependent variable, Final_Exam_Score, to identify any outliers.

```{r}
# Outliers in Final_Exam_Score
outliers_in_exam_score <- student_data[student_data$Exam_Score > 100,]
outliers_in_exam_score

# Removing outliers
student_data <- subset(student_data, Exam_Score <= 100)
```

We can see that only 1 student got exam score of 101 which is an outlier. We will remove this row from the dataset.

```{r}
# Remove outliers
student_data <- subset(student_data, Exam_Score <= 100)
```

We now plot a boxplot to visualize the distribution of final exam scores and identify any outliers.

```{r}
# Boxplot of final exam scores
boxplot(student_data$Exam_Score, main = "Boxplot of Final Exam Scores", col = "skyblue", border = "black")
```

We now use Interquartile Range (IQR) Method to identify and remove outliers in the Exam_Score column.

```{r}
# Calculate Q1, Q3 and IQR
Q1 <- quantile(student_data$Exam_Score, 0.25)
Q3 <- quantile(student_data$Exam_Score, 0.75)
IQR <- Q3 - Q1

# Calculate lower and upper bounds for outliers
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR

# Identify outliers
outliers_in_exam_score <- student_data[student_data$Exam_Score < lower_bound | student_data$Exam_Score > upper_bound,]
outliers_in_exam_score$Exam_Score
nrow(outliers_in_exam_score)
boxplot(outliers_in_exam_score$Exam_Score, main = "Boxplot of Final Exam Scores", col = "skyblue", border = "black")

# Remove outliers
student_data <- subset(student_data, Exam_Score >= lower_bound & Exam_Score <= upper_bound)
```


# Distribution of Final Exam Scores

## Distribution of Final Exam Scores (Without Considering Other Factors)
Here we will explore the distribution of final exam scores among students with without considering other factors.
To find our the distribution of final exam scores, we first need to sample the data and plot a histogram.
```{r}
# Sample the data
set.seed(123)
exam_score_sample <- student_data$Exam_Score[sample(nrow(student_data), round(nrow(student_data)*sample_fraction))]

# Plot histogram
hist(exam_score_sample, main = "Distribution of Final Exam Scores", xlab = "Final Exam Score", col = "skyblue", border = "black")
```

From the histogram, we can see that the distribution of final exam scores is positively skewed, with most students scoring between 60 and 75. There are a few students who scored below 60 and a few outliers who scored above 80. We will now create a boxplot to visualize the distribution further.
```{r}
# Boxplot of final exam scores
boxplot(exam_score_sample, main = "Boxplot of Final Exam Scores", col = "skyblue", border = "black")
```

The boxplot shows the distribution of final exam scores, with the median score around 70. There are a few outliers above 80, indicating that some students performed exceptionally well. We will now use numerical methods to confirm the normality of the distribution.
```{r}
# Shapiro-Wilk test for normality
shapiro.test(exam_score_sample)
```

The Shapiro-Wilk test confirms that the distribution of final exam scores is not normal, with a p-value less than 0.05.

## Distribution of Final Exam Scores (Parental_Involvement Category)

Next, we explore the distribution of final exam scores based on parental involvement levels. We will create a boxplot to compare the scores of students with different levels of parental involvement.
```{r}
# Sample the data
high_parental_involvement_exam_score <- student_data$Exam_Score[student_data$Parental_Involvement == "High"][sample(sum(student_data$Parental_Involvement == "High"), round(sum(student_data$Parental_Involvement == "High")*sample_fraction))]
medium_parental_involvement_exam_score <- student_data$Exam_Score[student_data$Parental_Involvement == "Medium"][sample(sum(student_data$Parental_Involvement == "Medium"), round(sum(student_data$Parental_Involvement == "Medium")*sample_fraction))]
low_parental_involvement_exam_score <- student_data$Exam_Score[student_data$Parental_Involvement == "Low"][sample(sum(student_data$Parental_Involvement == "Low"), round(sum(student_data$Parental_Involvement == "Low")*sample_fraction))]

# Histogram of final exam scores by parental involvement
par(mfrow = c(1, 3))
hist(high_parental_involvement_exam_score, main = "High Parental Involvement", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(medium_parental_involvement_exam_score, main = "Medium Parental Involvement", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(low_parental_involvement_exam_score, main = "Low Parental Involvement", xlab = "Final Exam Score", col = "skyblue", border = "black")
```

The three histograms show the distribution of final exam scores for students with high, medium, and low levels of parental involvement. We can see that the distribution of the scores seems to be similar across all three categories. They seem to follow a normal distribution, with a slight skew towards higher scores for students with high parental involvement.
We now use numerical methods to confirm the normality of the distributions.
```{r}
# Shapiro-Wilk test for normality
shapiro.test(high_parental_involvement_exam_score)
shapiro.test(medium_parental_involvement_exam_score)
shapiro.test(low_parental_involvement_exam_score)
```

The Shapiro-Wilk test confirms that the distributions of final exam scores for all students with of parental involvement are not normal, with p-values less than 0.05.

Now we take it a step further by checking whether the distribution of final exam scores is different based on parental involvement levels using Kruskal-Wallis test.

```{r}
# Summary statistics for final exam scores by parental involvement
summary(high_parental_involvement_exam_score)
summary(medium_parental_involvement_exam_score)
summary(low_parental_involvement_exam_score)

# Kruskal-Wallis test for final exam scores by parental involvement
kruskal.test(Exam_Score ~ Parental_Involvement, data = student_data)
```

The Kruskal-Wallis test shows that there is significant difference in the final exam scores based on parental involvement levels, with a p-value less than 0.05. This indicates that parental involvement has a significant impact on the final exam scores. From the summary statistics, we can see that students with high parental involvement have higher average exam scores, followed by students with medium parental involvement, and students with low parental involvement have the lowest average exam scores.

## Distribution of Final Exam Scores (Access_to_Resources Category)

Next, we explore the distribution of final exam scores based on access to resources. We will create a boxplot to compare the scores of students with different levels of access to resources.
```{r}
# Sample the data
high_access_to_resources_exam_score <- student_data$Exam_Score[student_data$Access_to_Resources == "High"][sample(sum(student_data$Access_to_Resources == "High"), round(sum(student_data$Access_to_Resources == "High")*sample_fraction))]
medium_access_to_resources_exam_score <- student_data$Exam_Score[student_data$Access_to_Resources == "Medium"][sample(sum(student_data$Access_to_Resources == "Medium"), round(sum(student_data$Access_to_Resources == "Medium")*sample_fraction))]
low_access_to_resources_exam_score <- student_data$Exam_Score[student_data$Access_to_Resources == "Low"][sample(sum(student_data$Access_to_Resources == "Low"), round(sum(student_data$Access_to_Resources == "Low")*sample_fraction))]

# Histogram of final exam scores by access to resources
par(mfrow = c(1, 3))
hist(high_access_to_resources_exam_score, main = "High Access to Resources", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(medium_access_to_resources_exam_score, main = "Medium Access to Resources", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(low_access_to_resources_exam_score, main = "Low Access to Resources", xlab = "Final Exam Score", col = "skyblue", border = "black")

plot(density(low_access_to_resources_exam_score), main = "Low Access to Resources", xlab = "Final Exam Score", col = "skyblue")
plot(density(medium_access_to_resources_exam_score), main = "Medium Access to Resources", xlab = "Final Exam Score", col = "skyblue")
plot(density(high_access_to_resources_exam_score), main = "High Access to Resources", xlab = "Final Exam Score", col = "skyblue")
```

The histograms and density plots show the distribution of final exam scores for students with high, medium, and low levels of access to resources. The distributions seem to be similar across all three categories, with a slight skew towards higher scores for students with high access to resources. We will now use numerical methods to confirm the normality of the distributions.

```{r}
# Shapiro-Wilk test for normality
shapiro.test(high_access_to_resources_exam_score)
shapiro.test(medium_access_to_resources_exam_score)
shapiro.test(low_access_to_resources_exam_score)
```

The Shapiro-Wilk test shows that the distributions of final exam scores for students with high, medium, and low access to resources are not normal, with p-values less than 0.05.

Next, we will use Kruskal-Wallis test to check whether the distribution of final exam scores is different based on access to resources.

```{r}
# Summary statistics for final exam scores by access to resources
summary(high_access_to_resources_exam_score)
summary(medium_access_to_resources_exam_score)
summary(low_access_to_resources_exam_score)

# Kruskal-Wallis test for final exam scores by access to resources
kruskal.test(Exam_Score ~ Access_to_Resources, data = student_data)
```

The Kruskal-Wallis test shows that there is a significant difference in the final exam scores based on access to resources, with a p-value less than 0.05. This indicates that access to resources has a significant impact on the final exam scores. From the summary statistics, we can see that students with high access to resources have higher average exam scores, followed by students with medium access to resources, and students with low access to resources have the lowest average exam scores.

## Distribution of Final Exam Scores (Extracurricular_Activities Category)

Next, we explore the distribution of final exam scores based on participation in extracurricular activities. We will create a boxplot to compare the scores of students who participate in extracurricular activities and those who do not.
```{r}
# Sample the data
participate_extracurricular_exam_score <- student_data$Exam_Score[student_data$Extracurricular_Activities == "Yes"][sample(sum(student_data$Extracurricular_Activities == "Yes"), round(sum(student_data$Extracurricular_Activities == "Yes")*sample_fraction))]
do_not_participate_extracurricular_exam_score <- student_data$Exam_Score[student_data$Extracurricular_Activities == "No"][sample(sum(student_data$Extracurricular_Activities == "No"), round(sum(student_data$Extracurricular_Activities == "No")*sample_fraction))]

# Boxplot of final exam scores by extracurricular activities
boxplot(student_data$Exam_Score ~ student_data$Extracurricular_Activities, main = "Final Exam Scores by Extracurricular Activities", xlab = "Extracurricular Activities", ylab = "Final Exam Score", col = "skyblue", border = "black")
```

The boxplot shows that students who participate in extracurricular activities tend to have higher final exam scores compared to those who do not. Now we will visualize the distribution of scores for both groups using histograms.
```{r}
# Histogram of final exam scores by extracurricular activities
par(mfrow = c(1, 2))
hist(participate_extracurricular_exam_score, main = "Extracurricular Activities", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(do_not_participate_extracurricular_exam_score, main = "No Extracurricular Activities", xlab = "Final Exam Score", col = "skyblue", border = "black")
```

Both histograms show normal distributions of final exam scores for students who participate in extracurricular activities and those who do not. We will now use numerical methods to confirm the normality of the distributions.

```{r}
# Shapiro-Wilk test for normality
shapiro.test(participate_extracurricular_exam_score)
shapiro.test(do_not_participate_extracurricular_exam_score)
```

The Shapiro-Wilk test confirms that both distributions of final exam scores for students who participate in extracurricular activities and those who do not are approximately normal, with p-values greater than 0.05.

Next, we will use t-test to check whether the distribution of final exam scores is different based on participation in extracurricular activities.

```{r}
# Summary statistics for final exam scores by extracurricular activities
summary(participate_extracurricular_exam_score)
summary(do_not_participate_extracurricular_exam_score)

# t-test for final exam scores by extracurricular activities
t.test(participate_extracurricular_exam_score, do_not_participate_extracurricular_exam_score)
```

The t-test shows that there is no significant difference in the final exam scores based on participation in extracurricular activities, with a p-value greater than 0.05. This indicates that participation in extracurricular activities does not have a significant impact on the final exam scores.

## Distribution of Final Exam Scores (Motivation_Level Category)

Next we explore the distribution of final exam scores based on motivation levels. We will create a histogram to compare the scores of students with different motivation levels.
```{r}
# Smaple Data
high_motivation_exam_score <- student_data$Exam_Score[student_data$Motivation_Level == "High"][sample(sum(student_data$Motivation_Level == "High"), round(sum(student_data$Motivation_Level == "High")*sample_fraction))]
medium_motivation_exam_score <- student_data$Exam_Score[student_data$Motivation_Level == "Medium"][sample(sum(student_data$Motivation_Level == "Medium"), round(sum(student_data$Motivation_Level == "Medium")*sample_fraction))]
low_motivation_exam_score <- student_data$Exam_Score[student_data$Motivation_Level == "Low"][sample(sum(student_data$Motivation_Level == "Low"), round(sum(student_data$Motivation_Level == "Low")*sample_fraction))]

# Histogram of final exam scores by motivation level
par(mfrow = c(1, 3))
hist(high_motivation_exam_score, main = "High Motivation Level", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(medium_motivation_exam_score, main = "Medium Motivation Level", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(low_motivation_exam_score, main = "Low Motivation Level", xlab = "Final Exam Score", col = "skyblue", border = "black")
```

- **High Motivation Level**: TExam scores are mostly concentrated between 65 and 75, indicating that students with high motivation consistently perform well. The peak frequency occurs at the middle of this range.
- **Medium Motivation Level**: Scores are also clustered between 65 and 75, but with slightly more variability compared to the high-motivation group. There appears to be a small tail of students scoring higher.
- **Low Motivation Level**: Scores are more widely spread between 60 and 75, with some outliers scoring much lower or higher.
The peak is lower than in the other groups, suggesting fewer students scoring consistently high.

```{r}
# Shapiro-Wilk test for normality
shapiro.test(high_motivation_exam_score)
shapiro.test(medium_motivation_exam_score)
shapiro.test(low_motivation_exam_score)
```

All tests show that the distribution of final exam scores for students with high, medium, and low motivation levels is not normal, with p-values less than 0.05.

Now we use Kruskal-Wallis test to check whether the distribution of final exam scores is different based on motivation levels.

```{r}
# Summary statistics for final exam scores by motivation level
summary(high_motivation_exam_score)
summary(medium_motivation_exam_score)
summary(low_motivation_exam_score)

# Kruskal-Wallis test for final exam scores by motivation level
kruskal.test(Exam_Score ~ Motivation_Level, data = student_data)
```

The Kruskal-Wallis test shows that there is a significant difference in the final exam scores based on motivation levels, with a p-value less than 0.05. This indicates that motivation levels have a significant impact on the final exam scores. From the summary statistics, we can see that students with high motivation have higher average exam scores, followed by students with medium motivation, and students with low motivation have the lowest average exam scores.



## Distribution of Final Exam Scores (Internet_Access Category)

Next, we explore the distribution of final exam scores based on internet access. We will create a boxplot to compare the scores of students with and without internet access.
```{r}
# Sample the data
internet_access_exam_score <- student_data$Exam_Score[student_data$Internet_Access == "Yes"][sample(sum(student_data$Internet_Access == "Yes"), round(sum(student_data$Internet_Access == "Yes")*sample_fraction))]
no_internet_access_exam_score <- student_data$Exam_Score[student_data$Internet_Access == "No"][sample(sum(student_data$Internet_Access == "No"), round(sum(student_data$Internet_Access == "No")*sample_fraction))]

# Histogram of final exam scores by internet access
par(mfrow = c(1, 2))
hist(internet_access_exam_score, main = "Internet Access", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(no_internet_access_exam_score, main = "No Internet Access", xlab = "Final Exam Score", col = "skyblue", border = "black")
```

- **Internet Access**: The distribution appears fairly symmetric, with most scores clustered between 63 and 70. The mode or most frequent score seems to fall around 65-68. Scores are concentrated between 60 and 70 , with few below or above this range. the histogram shows a moderate spread of scores, indicating consistent performance among students.
- **No Internet Access**: This distribution is slightly skewed, with scores primarily clustered around 65 and extending toward 70. There are some outliers beyond 75. The highest frequency occurs around 65. Scores are more widely distributed compared to the __Internet Access__ group, with some students scoring as low as 55 and others exceeding 80. The group is larger, as seen by the higher frequency values (bars).

```{r}
# Shapiro-Wilk test for normality
shapiro.test(internet_access_exam_score)
shapiro.test(no_internet_access_exam_score)
```

The Shapiro-Wilk test confirms that the distribution of final exam scores for students with and without internet access is not normal, with a p-value less than 0.05.

Next, we use Wilcoxon rank-sum test to check whether the distribution of final exam scores is different based on internet access.

```{r}
# Summary statistics for final exam scores by internet access
summary(internet_access_exam_score)
summary(no_internet_access_exam_score)

# Wilcoxon rank-sum test for final exam scores by internet access
wilcox.test(internet_access_exam_score, no_internet_access_exam_score)
```

The Wilcoxon rank-sum test shows that there is a significant difference in the final exam scores based on internet access, with a p-value less than 0.05. This indicates that internet access has a significant impact on the final exam scores. From the summary statistics, we can see that students with internet access have higher average exam scores compared to students without internet access.

## Distribution of Final Exam Scores (Family_Income Category)

Next, we explore the distribution of final exam scores based on family income levels.

```{r}
# Sample the data
low_income_exam_score <- student_data$Exam_Score[student_data$Family_Income == "Low"][sample(sum(student_data$Family_Income == "Low"), round(sum(student_data$Family_Income == "Low")*sample_fraction))]
medium_income_exam_score <- student_data$Exam_Score[student_data$Family_Income == "Medium"][sample(sum(student_data$Family_Income == "Medium"), round(sum(student_data$Family_Income == "Medium")*sample_fraction))]
high_income_exam_score <- student_data$Exam_Score[student_data$Family_Income == "High"][sample(sum(student_data$Family_Income == "High"), round(sum(student_data$Family_Income == "High")*sample_fraction))]

# Histogram of final exam scores by family income
par(mfrow = c(1, 3))
hist(low_income_exam_score, main = "Low Family Income", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(medium_income_exam_score, main = "Medium Family Income", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(high_income_exam_score, main = "High Family Income", xlab = "Final Exam Score", col = "skyblue", border = "black")

# Shapiro-Wilk test for normality
shapiro.test(low_income_exam_score)
shapiro.test(medium_income_exam_score)
shapiro.test(high_income_exam_score)
```
The Shapiro-Wilk test confirms that the distribution of final exam scores for all students is not normal, with a p-value that is less than 0.05.

We now use Wilcoxon rank-sum test to check whether the distribution of final exam scores is different based on family income.

```{r}
# Summary statistics for final exam scores by family income
summary(low_income_exam_score)
summary(medium_income_exam_score)
summary(high_income_exam_score)

# Wilcoxon rank-sum test for final exam scores by family income
wilcox.test(low_income_exam_score, high_income_exam_score)
```

The Wilcoxon rank-sum test shows that there is a significant difference in the final exam scores based on family income levels, with a p-value less than 0.05. This indicates that family income has a significant impact on the final exam scores. From the summary statistics, we can see that students from high-income families have higher average exam scores compared to students from low-income families.

## Distribution of Final Exam Scores (Teacher_Quality Category)

Next, we explore the distribution of final exam scores based on teacher quality levels.

```{r}
# Sample data
high_teacher_quality_exam_score <- student_data$Exam_Score[student_data$Teacher_Quality == "High"][sample(sum(student_data$Teacher_Quality == "High"), round(sum(student_data$Teacher_Quality == "High")*sample_fraction))]
medium_teacher_quality_exam_score <- student_data$Exam_Score[student_data$Teacher_Quality == "Medium"][sample(sum(student_data$Teacher_Quality == "Medium"), round(sum(student_data$Teacher_Quality == "Medium")*sample_fraction))]
low_teacher_quality_exam_score <- student_data$Exam_Score[student_data$Teacher_Quality == "Low"][sample(sum(student_data$Teacher_Quality == "Low"), round(sum(student_data$Teacher_Quality == "Low")*sample_fraction))]

# Histogram of final exam scores by teacher quality
par(mfrow = c(1, 3))
hist(high_teacher_quality_exam_score, main = "High Teacher Quality", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(medium_teacher_quality_exam_score, main = "Medium Teacher Quality", xlab = "Final Exam Score", col = "skyblue", border = "black")
hist(low_teacher_quality_exam_score, main = "Low Teacher Quality", xlab = "Final Exam Score", col = "skyblue", border = "black")
```


## Summary of Distribution Analysis

In summary, the analysis of the distribution of final exam scores and study hours across various categories such as parental involvement, access to resources, extracurricular activities, motivation levels, internet access, family income, teacher quality, school type, peer influence, learning disabilities, parental education levels, distance from home to school, and gender shows no significant differences. The distributions are approximately normal in most cases, with a few exceptions where the distributions are slightly skewed. Overall, these factors do not have a significant impact on the final exam scores or the number of hours students study per week.

# Average number of hours students study per week

## Average Number of Hours Students Study per Week (Without Considering Other Factors)

Next, we explore the average number of hours students study per week without considering other factors.
```{r}
# Sample the data
sample_hours_studied <- student_data$Hours_Studied[sample(nrow(student_data), round(nrow(student_data)*sample_fraction))]
summary(sample_hours_studied)
```

We will now visualize the distribution of study hours using a histogram.
```{r}
# Histogram of study hours
hist(sample_hours_studied, main = "Distribution of Study Hours", xlab = "Study Hours", col = "skyblue", border = "black")
```

The distribution of study hours is approximately normal. We will now use numerical methods to confirm the normality of the distribution.

```{r}
# Shapiro-Wilk test for normality
shapiro.test(sample_hours_studied)
```

The p-value is greater than 0.05, indicating that the distribution of study hours is approximately normal.

## Average Number of Hours Students Study per Week (Parental_Involvement Category)

Next, we will explore the average number of hours students study per week based on parental involvement levels.
```{r}
# Sample the data
high_parental_involvement_hrs <- student_data$Hours_Studied[student_data$Parental_Involvement == "High"][sample(sum(student_data$Parental_Involvement == "High"), round(sum(student_data$Parental_Involvement == "High")*sample_fraction))]
medium_parental_involvement_hrs <- student_data$Hours_Studied[student_data$Parental_Involvement == "Medium"][sample(sum(student_data$Parental_Involvement == "Medium"), round(sum(student_data$Parental_Involvement == "Medium")*sample_fraction))]
low_parental_involvement_hrs <- student_data$Hours_Studied[student_data$Parental_Involvement == "Low"][sample(sum(student_data$Parental_Involvement == "Low"), round(sum(student_data$Parental_Involvement == "Low")*sample_fraction))]

# Summary statistics for study hours by parental involvement
summary(high_parental_involvement_hrs)
summary(medium_parental_involvement_hrs)
summary(low_parental_involvement_hrs)
```

The summary statistics of the average number of hours students study per week based on parental involvement levels do not show significant differences. We will now use ANOVA to test for differences in study hours based on parental involvement levels. But first, we need to check the assumptions of ANOVA.
```{r}
# Histogram of study hours by parental involvement
par(mfrow = c(1, 3))
hist(high_parental_involvement_hrs, main = "High Parental Involvement", xlab = "Study Hours", col = "skyblue", border = "black")
hist(medium_parental_involvement_hrs, main = "Medium Parental Involvement", xlab = "Study Hours", col = "skyblue", border = "black")
hist(low_parental_involvement_hrs, main = "Low Parental Involvement", xlab = "Study Hours", col = "skyblue", border = "black")


# Check assumptions of ANOVA
shapiro.test(high_parental_involvement_hrs)
shapiro.test(medium_parental_involvement_hrs)
shapiro.test(low_parental_involvement_hrs)
```

Both the histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on parental involvement levels.
```{r}
# ANOVA test for study hours by parental involvement
anova_parental_involvement <- aov(Hours_Studied ~ Parental_Involvement, data = student_data)
summary(anova_parental_involvement)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on parental involvement levels, with a p-value greater than 0.05. This indicates that parental involvement does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Access_to_Resources Category)

We now explore the average number of hours students study per week based on access to resources.

```{r}
# Sample the data
high_access_to_resources_hrs <- student_data$Hours_Studied[student_data$Access_to_Resources == "High"][sample(sum(student_data$Access_to_Resources == "High"), round(sum(student_data$Access_to_Resources == "High")*sample_fraction))]
medium_access_to_resources_hrs <- student_data$Hours_Studied[student_data$Access_to_Resources == "Medium"][sample(sum(student_data$Access_to_Resources == "Medium"), round(sum(student_data$Access_to_Resources == "Medium")*sample_fraction))]
low_access_to_resources_hrs <- student_data$Hours_Studied[student_data$Access_to_Resources == "Low"][sample(sum(student_data$Access_to_Resources == "Low"), round(sum(student_data$Access_to_Resources == "Low")*sample_fraction))]

# Summary statistics for study hours by access to resources
summary(high_access_to_resources_hrs)
summary(medium_access_to_resources_hrs)
summary(low_access_to_resources_hrs)
```

The summary statistics of the average number of hours students study per week based on access to resources do not show significant differences. We will now use ANOVA to test for differences in study hours based on access to resources. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by access to resources
par(mfrow = c(1, 3))
hist(high_access_to_resources_hrs, main = "High Access to Resources", xlab = "Study Hours", col = "skyblue", border = "black")
hist(medium_access_to_resources_hrs, main = "Medium Access to Resources", xlab = "Study Hours", col = "skyblue", border = "black")
hist(low_access_to_resources_hrs, main = "Low Access to Resources", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_access_to_resources_hrs)
shapiro.test(medium_access_to_resources_hrs)
shapiro.test(low_access_to_resources_hrs)
```

Both the histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on access to resources.
```{r}
# ANOVA test for study hours by access to resources
anova_access_to_resources <- aov(Hours_Studied ~ Access_to_Resources, data = student_data)
summary(anova_access_to_resources)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on access to resources, with a p-value greater than 0.05. This indicates that access to resources does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Extracurricular_Activities Category)

Next, we explore the average number of hours students study per week based on participation in extracurricular activities.
```{r}
# Sample the data
participate_extracurricular_hrs <- student_data$Hours_Studied[student_data$Extracurricular_Activities == "Yes"][sample(sum(student_data$Extracurricular_Activities == "Yes"), round(sum(student_data$Extracurricular_Activities == "Yes")*sample_fraction))]
do_not_participate_extracurricular_hrs <- student_data$Hours_Studied[student_data$Extracurricular_Activities == "No"][sample(sum(student_data$Extracurricular_Activities == "No"), round(sum(student_data$Extracurricular_Activities == "No")*sample_fraction))]

# Summary statistics for study hours by extracurricular activities
summary(participate_extracurricular_hrs)
summary(do_not_participate_extracurricular_hrs)
```

The summary statistics of the average number of hours students study per week based on participation in extracurricular activities show no significant differences. We will now use t-test to test for differences in study hours based on participation in extracurricular activities. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of study hours by extracurricular activities
par(mfrow = c(1, 2))
hist(participate_extracurricular_hrs, main = "Extracurricular Activities", xlab = "Study Hours", col = "skyblue", border = "black")
hist(do_not_participate_extracurricular_hrs, main = "No Extracurricular Activities", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(participate_extracurricular_hrs)
shapiro.test(do_not_participate_extracurricular_hrs)
```

Both the histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use t-test to test for differences in study hours based on participation in extracurricular activities.

```{r}
# t-test test for study hours by extracurricular activities
t.test(participate_extracurricular_hrs, do_not_participate_extracurricular_hrs)
```

The t-test shows that there is no significant difference in the average number of hours students study per week based on participation in extracurricular activities, with a p-value greater than 0.05. This indicates that participation in extracurricular activities does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Motivation_Level Category)

Next, we explore the average number of hours students study per week based on motivation levels.
```{r}
# Sample the data
high_motivation_hrs <- student_data$Hours_Studied[student_data$Motivation_Level == "High"][sample(sum(student_data$Motivation_Level == "High"), round(sum(student_data$Motivation_Level == "High")*sample_fraction))]
medium_motivation_hrs <- student_data$Hours_Studied[student_data$Motivation_Level == "Medium"][sample(sum(student_data$Motivation_Level == "Medium"), round(sum(student_data$Motivation_Level == "Medium")*sample_fraction))]
low_motivation_hrs <- student_data$Hours_Studied[student_data$Motivation_Level == "Low"][sample(sum(student_data$Motivation_Level == "Low"), round(sum(student_data$Motivation_Level == "Low")*sample_fraction))]

# Summary statistics for study hours by motivation level
summary(high_motivation_hrs)
summary(medium_motivation_hrs)
summary(low_motivation_hrs)
```

The summary statistics of the average number of hours students study per week based on motivation levels show no significant differences. We will now use ANOVA to test for differences in study hours based on motivation levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by motivation level
par(mfrow = c(1, 3))
hist(high_motivation_hrs, main = "High Motivation Level", xlab = "Study Hours", col = "skyblue", border = "black")
hist(medium_motivation_hrs, main = "Medium Motivation Level", xlab = "Study Hours", col = "skyblue", border = "black")
hist(low_motivation_hrs, main = "Low Motivation Level", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_motivation_hrs)
shapiro.test(medium_motivation_hrs)
shapiro.test(low_motivation_hrs)
```

Shapiro-Wilk test shows that the distribution of study hours of students with medium motivation is not normal, with a p-value less than 0.05. We will now use Kruksal-Wallis test to test for differences in study hours based on motivation levels.

```{r}
# Kruskal-Wallis test for study hours by motivation level
kruskal.test(Hours_Studied ~ Motivation_Level, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average number of hours students study per week based on motivation levels, with a p-value greater than 0.05. This indicates that motivation levels do not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Internet Access Category)

Next, we explore the average number of hours students study per week based on internet access.

```{r}
# Sample the data
internet_access_hrs <- student_data$Hours_Studied[student_data$Internet_Access == "Yes"][sample(sum(student_data$Internet_Access == "Yes"), round(sum(student_data$Internet_Access == "Yes")*sample_fraction))]
no_internet_access_hrs <- student_data$Hours_Studied[student_data$Internet_Access == "No"][sample(sum(student_data$Internet_Access == "No"), round(sum(student_data$Internet_Access == "No")*sample_fraction))]

# Summary statistics for study hours by internet access
summary(internet_access_hrs)
summary(no_internet_access_hrs)
```

The summary statistics of the average number of hours students study per week based on internet access show no significant differences. We will now use t-test to test for differences in study hours based on internet access. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of study hours by internet access
par(mfrow = c(1, 2))
hist(internet_access_hrs, main = "Internet Access", xlab = "Study Hours", col = "skyblue", border = "black")
hist(no_internet_access_hrs, main = "No Internet Access", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(internet_access_hrs)
shapiro.test(no_internet_access_hrs)
```

Both the histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use t-test to test for differences in study hours based on internet access.

```{r}
# t-test test for study hours by internet access
t.test(internet_access_hrs, no_internet_access_hrs)
```

The p-value is less than 0.05, indicating that there is a significant difference in the average number of hours students study per week based on internet access. This suggests that internet access has a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Family Income Category)

Next, we explore the average number of hours students study per week based on family income levels.

```{r}
# Sample the data
low_family_income_hrs <- student_data$Hours_Studied[student_data$Family_Income == "Low"][sample(sum(student_data$Family_Income == "Low"), round(sum(student_data$Family_Income == "Low")*sample_fraction))]
medium_family_income_hrs <- student_data$Hours_Studied[student_data$Family_Income == "Medium"][sample(sum(student_data$Family_Income == "Medium"), round(sum(student_data$Family_Income == "Medium")*sample_fraction))]
high_family_income_hrs <- student_data$Hours_Studied[student_data$Family_Income == "High"][sample(sum(student_data$Family_Income == "High"), round(sum(student_data$Family_Income == "High")*sample_fraction))]

# Summary statistics for study hours by family income
summary(low_family_income_hrs)
summary(medium_family_income_hrs)
summary(high_family_income_hrs)
```

The summary statistics of the average number of hours students study per week based on family income levels show no significant differences. We will now use ANOVA to test for differences in study hours based on family income levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by family income
par(mfrow = c(1, 3))
hist(low_family_income_hrs, main = "Low Family Income", xlab = "Study Hours", col = "skyblue", border = "black")
hist(medium_family_income_hrs, main = "Medium Family Income", xlab = "Study Hours", col = "skyblue", border = "black")
hist(high_family_income_hrs, main = "High Family Income", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(low_family_income_hrs)
shapiro.test(medium_family_income_hrs)
shapiro.test(high_family_income_hrs)
```

Both the histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on family income levels.

```{r}
# ANOVA test for study hours by family income
anova_family_income <- aov(Hours_Studied ~ Family_Income, data = student_data)
summary(anova_family_income)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on family income levels, with a p-value greater than 0.05. This indicates that family income does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Teacher Quality Category)

Next, we explore the average number of hours students study per week based on teacher quality levels.

```{r}
# Sample the data
low_teacher_quality_hrs <- student_data$Hours_Studied[student_data$Teacher_Quality == "Low"][sample(sum(student_data$Teacher_Quality == "Low"), round(sum(student_data$Teacher_Quality == "Low")*sample_fraction))]
medium_teacher_quality_hrs <- student_data$Hours_Studied[student_data$Teacher_Quality == "Medium"][sample(sum(student_data$Teacher_Quality == "Medium"), round(sum(student_data$Teacher_Quality == "Medium")*sample_fraction))]
high_teacher_quality_hrs <- student_data$Hours_Studied[student_data$Teacher_Quality == "High"][sample(sum(student_data$Teacher_Quality == "High"), round(sum(student_data$Teacher_Quality == "High")*sample_fraction))]

# Summary statistics for study hours by teacher quality
summary(low_teacher_quality_hrs)
summary(medium_teacher_quality_hrs)
summary(high_teacher_quality_hrs)
```

The summary statistics of the average number of hours students study per week based on teacher quality levels show no significant differences. We will now use ANOVA to test for differences in study hours based on teacher quality levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by teacher quality
par(mfrow = c(1, 3))
hist(low_teacher_quality_hrs, main = "Low Teacher Quality", xlab = "Study Hours", col = "skyblue", border = "black")
hist(medium_teacher_quality_hrs, main = "Medium Teacher Quality", xlab = "Study Hours", col = "skyblue", border = "black")
hist(high_teacher_quality_hrs, main = "High Teacher Quality", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(low_teacher_quality_hrs)
shapiro.test(medium_teacher_quality_hrs)
shapiro.test(high_teacher_quality_hrs)
```

All three histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on teacher quality levels.

```{r}
# ANOVA test for study hours by teacher quality
anova_teacher_quality <- aov(Hours_Studied ~ Teacher_Quality, data = student_data)
summary(anova_teacher_quality)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on teacher quality levels, with a p-value greater than 0.05. This indicates that teacher quality does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (School Type Category)

Next, we explore the average number of hours students study per week based on school type.

```{r}
# Sample the data
public_school_hrs <- student_data$Hours_Studied[student_data$School_Type == "Public"][sample(sum(student_data$School_Type == "Public"), round(sum(student_data$School_Type == "Public")*sample_fraction))]
private_school_hrs <- student_data$Hours_Studied[student_data$School_Type == "Private"][sample(sum(student_data$School_Type == "Private"), round(sum(student_data$School_Type == "Private")*sample_fraction))]

# Summary statistics for study hours by school type
summary(public_school_hrs)
summary(private_school_hrs)
```

The summary statistics of the average number of hours students study per week based on school type show no significant differences. We will now use t-test to test for differences in study hours based on school type. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of study hours by school type
par(mfrow = c(1, 2))
hist(public_school_hrs, main = "Public School", xlab = "Study Hours", col = "skyblue", border = "black")
hist(private_school_hrs, main = "Private School", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(public_school_hrs)
shapiro.test(private_school_hrs)
```

Both histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use t-test to test for differences in study hours based on school type.

```{r}
# t-test test for study hours by school type
t.test(public_school_hrs, private_school_hrs)
```

The t-test test shows that there is no significant difference in the average number of hours students study per week based on school type, with a p-value greater than 0.05. This indicates that school type does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Peer Influence Category)

Next, we explore the average number of hours students study per week based on peer influence levels.

```{r}
# Sample the data
positive_peer_influence_hrs <- student_data$Hours_Studied[student_data$Peer_Influence == "Positive"][sample(sum(student_data$Peer_Influence == "Positive"), round(sum(student_data$Peer_Influence == "Positive")*sample_fraction))]
negative_peer_influence_hrs <- student_data$Hours_Studied[student_data$Peer_Influence == "Negative"][sample(sum(student_data$Peer_Influence == "Negative"), round(sum(student_data$Peer_Influence == "Negative")*sample_fraction))]
neutral_peer_influence_hrs <- student_data$Hours_Studied[student_data$Peer_Influence == "Neutral"][sample(sum(student_data$Peer_Influence == "Neutral"), round(sum(student_data$Peer_Influence == "Neutral")*sample_fraction))]

# Summary statistics for study hours by peer influence
summary(positive_peer_influence_hrs)
summary(negative_peer_influence_hrs)
summary(neutral_peer_influence_hrs)
```

The summary statistics of the average number of hours students study per week based on peer influence levels show no significant differences. We will now use ANOVA to test for differences in study hours based on peer influence levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by peer influence
par(mfrow = c(1, 3))
hist(positive_peer_influence_hrs, main = "Positive Peer Influence", xlab = "Study Hours", col = "skyblue", border = "black")
hist(negative_peer_influence_hrs, main = "Negative Peer Influence", xlab = "Study Hours", col = "skyblue", border = "black")
hist(neutral_peer_influence_hrs, main = "Neutral Peer Influence", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(positive_peer_influence_hrs)
shapiro.test(negative_peer_influence_hrs)
shapiro.test(neutral_peer_influence_hrs)
```

All three histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on peer influence levels.

```{r}
# ANOVA test for study hours by peer influence
anova_peer_influence <- aov(Hours_Studied ~ Peer_Influence, data = student_data)
summary(anova_peer_influence)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on peer influence levels, with a p-value greater than 0.05. This indicates that peer influence does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Learning Disability Category)

Next, we explore the average number of hours students study per week based on learning disability.

```{r}
# Sample the data
learning_disabilities_hrs <- student_data$Hours_Studied[student_data$Learning_Disabilities == "Yes"][sample(sum(student_data$Learning_Disabilities == "Yes"), round(sum(student_data$Learning_Disabilities == "Yes")*sample_fraction))]
no_learning_disabilities_hrs <- student_data$Hours_Studied[student_data$Learning_Disabilities == "No"][sample(sum(student_data$Learning_Disabilities == "No"), round(sum(student_data$Learning_Disabilities == "No")*sample_fraction))]

# Summary statistics for study hours by learning disability
summary(learning_disabilities_hrs)
summary(no_learning_disabilities_hrs)
```

The summary statistics of the average number of hours students study per week based on learning disability show no significant differences. We will now use t-test to test for differences in study hours based on learning disability. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of study hours by learning disability
par(mfrow = c(1, 2))
hist(learning_disabilities_hrs, main = "Learning Disabilities", xlab = "Study Hours", col = "skyblue", border = "black")
hist(no_learning_disabilities_hrs, main = "No Learning Disabilities", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(learning_disabilities_hrs)
shapiro.test(no_learning_disabilities_hrs)
```

The Shapiro-Wilk test shows that the distribution of study hours is approximately normal for students with learning disabilities, with a p-value greater than 0.05. However, the distribution for students without learning disabilities is slightly skewed, with a p-value less than 0.05. We will now use wilcoxon rank sum test to test for differences in study hours based on learning disability.

```{r}
# Wilcoxon rank sum test for study hours by learning disability
wilcox.test(learning_disabilities_hrs, no_learning_disabilities_hrs)
```

The Wilcoxon rank sum test shows that there is no significant difference in the average number of hours students study per week based on learning disability, with a p-value greater than 0.05. This indicates that learning disabilities do not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Parental Education Level Category)

Next, we explore the average number of hours students study per week based on parental education levels.

```{r}
# Sample the data
high_school_education_hrs <- student_data$Hours_Studied[student_data$Parental_Education_Level == "High School"][sample(sum(student_data$Parental_Education_Level == "High School"), round(sum(student_data$Parental_Education_Level == "High School")*sample_fraction))]
college_education_hrs <- student_data$Hours_Studied[student_data$Parental_Education_Level == "College"][sample(sum(student_data$Parental_Education_Level == "College"), round(sum(student_data$Parental_Education_Level == "College")*sample_fraction))]
postgraduate_education_hrs <- student_data$Hours_Studied[student_data$Parental_Education_Level == "Postgraduate"][sample(sum(student_data$Parental_Education_Level == "Postgraduate"), round(sum(student_data$Parental_Education_Level == "Postgraduate")*sample_fraction))]

# Summary statistics for study hours by parental education level
summary(high_school_education_hrs)
summary(college_education_hrs)
summary(postgraduate_education_hrs)
```

The summary statistics of the average number of hours students study per week based on parental education levels show no significant differences. We will now use ANOVA to test for differences in study hours based on parental education levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by parental education level
par(mfrow = c(1, 3))
hist(high_school_education_hrs, main = "High School Education", xlab = "Study Hours", col = "skyblue", border = "black")
hist(college_education_hrs, main = "College Education", xlab = "Study Hours", col = "skyblue", border = "black")
hist(postgraduate_education_hrs, main = "Postgraduate Education", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_school_education_hrs)
shapiro.test(college_education_hrs)
shapiro.test(postgraduate_education_hrs)
```

All three histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on parental education levels.

```{r}
# ANOVA test for study hours by parental education level
anova_parental_education_level <- aov(Hours_Studied ~ Parental_Education_Level, data = student_data)
summary(anova_parental_education_level)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on parental education levels, with a p-value greater than 0.05. This indicates that parental education levels do not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Distance from Home Category)

Next, we explore the average number of hours students study per week based on the distance from home to school.

```{r}
# Sample the data
near_distance_hrs <- student_data$Hours_Studied[student_data$Distance_from_Home == "Near"][sample(sum(student_data$Distance_from_Home == "Near"), round(sum(student_data$Distance_from_Home == "Near")*sample_fraction))]
moderate_distance_hrs <- student_data$Hours_Studied[student_data$Distance_from_Home == "Moderate"][sample(sum(student_data$Distance_from_Home == "Moderate"), round(sum(student_data$Distance_from_Home == "Moderate")*sample_fraction))]
far_distance_hrs <- student_data$Hours_Studied[student_data$Distance_from_Home == "Far"][sample(sum(student_data$Distance_from_Home == "Far"), round(sum(student_data$Distance_from_Home == "Far")*sample_fraction))]

# Summary statistics for study hours by distance from home (Near, Moderate, Far
summary(near_distance_hrs)
summary(moderate_distance_hrs)
summary(far_distance_hrs)
```

The summary statistics of the average number of hours students study per week based on the distance from home to school show no significant differences. We will now use ANOVA to test for differences in study hours based on the distance from home to school. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of study hours by distance from home
par(mfrow = c(1, 3))
hist(near_distance_hrs, main = "Near Distance from Home", xlab = "Study Hours", col = "skyblue", border = "black")
hist(moderate_distance_hrs, main = "Moderate Distance from Home", xlab = "Study Hours", col = "skyblue", border = "black")
hist(far_distance_hrs, main = "Far Distance from Home", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(near_distance_hrs)
shapiro.test(moderate_distance_hrs)
shapiro.test(far_distance_hrs)
```

All three histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based on the distance from home to school.

```{r}
# ANOVA test for study hours by distance from home
anova_distance_from_home <- aov(Hours_Studied ~ Distance_from_Home, data = student_data)
summary(anova_distance_from_home)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study per week based on the distance from home to school, with a p-value greater than 0.05. This indicates that the distance from home to school does not have a significant impact on the number of hours students study per week.

## Average Number of Hours Students Study per Week (Gender Category)

Finally, we explore the average number of hours students study per week based on gender.

```{r}
# Sample the data
male_data_hrs <- student_data$Hours_Studied[student_data$Gender == "Male"][sample(sum(student_data$Gender == "Male"), round(sum(student_data$Gender == "Male")*sample_fraction))]
female_data_hrs <- student_data$Hours_Studied[student_data$Gender == "Female"][sample(sum(student_data$Gender == "Female"), round(sum(student_data$Gender == "Female")*sample_fraction))]

# Summary statistics
summary(male_data_hrs)
summary(female_data_hrs)
```

The summary statistics of the average number of hours students study per week based on gender show no significant differences. We will now use ANOVA to test for differences in study hours based on gender. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram
par(mfrow = c(1, 2))
hist(male_data_hrs, main = "Male", xlab = "Study Hours", col = "skyblue", border = "black")
hist(female_data_hrs, main = "Female", xlab = "Study Hours", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(male_data_hrs)
shapiro.test(female_data_hrs)
```

Both histograms and the Shapiro-Wilk test show that the distribution of study hours is approximately normal for all students. We will now use ANOVA to test for differences in study hours based gender.

```{r}
# ANOVA test
anova_gender <- aov(Hours_Studied ~ Gender, data = student_data)
summary(anova_gender)
```

The ANOVA test shows that there is no significant difference in the average number of hours students study based on gender.

## Summary of Average Number of Hours Students Study per Week

In summary, we have explored the average number of hours students study per week based on various factors such as access to resources, extracurricular activities, motivation levels, internet access, family income, teacher quality, school type, peer influence, learning disabilities, parental education levels, distance from home to school, and gender. From our analysis we found that only internet access had a significant impact on the number of hours students study per week. The other factors did not show significant differences in study hours. This suggests that internet access plays a crucial role in determining the number of hours students study per week.

# The variation in attendance rates across students

Now we analyze the variation in attendance rates across students.

```{r}
# Sample the data
sample_attendance <- student_data$Attendance[sample(nrow(student_data), round(nrow(student_data)*sample_fraction))]

# Summary statistics for attendance rates
summary(sample_attendance)

# Histogram of attendance rates
hist(sample_attendance, main = "Distribution of Attendance Rates", xlab = "Attendance Rate", col = "skyblue", border = "black")
```

From the histogram we can see that the distribution of attendance rates is approximately uniform, ranging from approximately **`60%`** to **`100%`**. We can see one slightly higher peak around **`90%`** to **`100%`**. From this we can see that attendance rates are evenly distributed across students. The average attendance rate is approximately **`79.75%`**, which is relatively high. We now investigate the factors that may influence attendance rates.

## Attendance Rates by Parental Involvement

We will now explore the attendance rates based on parental involvement levels.

```{r}
# Sample the data
high_parental_involvement_attendance <- student_data$Attendance[student_data$Parental_Involvement == "High"][sample(sum(student_data$Parental_Involvement == "High"), round(sum(student_data$Parental_Involvement == "High")*sample_fraction))]
medium_parental_involvement_attendance <- student_data$Attendance[student_data$Parental_Involvement == "Medium"][sample(sum(student_data$Parental_Involvement == "Medium"), round(sum(student_data$Parental_Involvement == "Medium")*sample_fraction))]
low_parental_involvement_attendance <- student_data$Attendance[student_data$Parental_Involvement == "Low"][sample(sum(student_data$Parental_Involvement == "Low"), round(sum(student_data$Parental_Involvement == "Low")*sample_fraction))]

# Summary statistics for attendance rates by parental involvement
summary(high_parental_involvement_attendance)
summary(medium_parental_involvement_attendance)
summary(low_parental_involvement_attendance)
```

The summary statistics of the attendance rates based on parental involvement levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on parental involvement levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by parental involvement
par(mfrow = c(1, 3))
hist(high_parental_involvement_attendance, main = "High Parental Involvement", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(medium_parental_involvement_attendance, main = "Medium Parental Involvement", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(low_parental_involvement_attendance, main = "Low Parental Involvement", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_parental_involvement_attendance)
shapiro.test(medium_parental_involvement_attendance)
shapiro.test(low_parental_involvement_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on parental involvement levels.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Parental_Involvement, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on parental involvement levels, with a p-value greater than 0.05. This indicates that parental involvement does not have a significant impact on attendance rates.

## Attendance Rates by Access to Resources

Next, we explore the attendance rates based on access to resources.

```{r}
# Sample the data
high_access_to_resources_attendance <- student_data$Attendance[student_data$Access_to_Resources == "High"][sample(sum(student_data$Access_to_Resources == "High"), round(sum(student_data$Access_to_Resources == "High")*sample_fraction))]
medium_access_to_resources_attendance <- student_data$Attendance[student_data$Access_to_Resources == "Medium"][sample(sum(student_data$Access_to_Resources == "Medium"), round(sum(student_data$Access_to_Resources == "Medium")*sample_fraction))]
low_access_to_resources_attendance <- student_data$Attendance[student_data$Access_to_Resources == "Low"][sample(sum(student_data$Access_to_Resources == "Low"), round(sum(student_data$Access_to_Resources == "Low")*sample_fraction))]

# Summary statistics for attendance rates by access to resources
summary(high_access_to_resources_attendance)
summary(medium_access_to_resources_attendance)
summary(low_access_to_resources_attendance)
```

The summary statistics of the attendance rates based on access to resources show no significant differences. We will now use ANOVA to test for differences in attendance rates based on access to resources. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by access to resources
par(mfrow = c(1, 3))
hist(high_access_to_resources_attendance, main = "High Access to Resources", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(medium_access_to_resources_attendance, main = "Medium Access to Resources", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(low_access_to_resources_attendance, main = "Low Access to Resources", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_access_to_resources_attendance)
shapiro.test(medium_access_to_resources_attendance)
shapiro.test(low_access_to_resources_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on access to resources.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Access_to_Resources, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on access to resources, with a p-value greater than 0.05. This indicates that access to resources does not have a significant impact on attendance rates.

## Attendance Rates by Extracurricular Activities

Next, we explore the attendance rates based on participation in extracurricular activities.

```{r}
# Sample the data
participate_extracurricular_attendance <- student_data$Attendance[student_data$Extracurricular_Activities == "Yes"][sample(sum(student_data$Extracurricular_Activities == "Yes"), round(sum(student_data$Extracurricular_Activities == "Yes")*sample_fraction))]
do_not_participate_extracurricular_attendance <- student_data$Attendance[student_data$Extracurricular_Activities == "No"][sample(sum(student_data$Extracurricular_Activities == "No"), round(sum(student_data$Extracurricular_Activities == "No")*sample_fraction))]

# Summary statistics for attendance rates by extracurricular activities
summary(participate_extracurricular_attendance)
summary(do_not_participate_extracurricular_attendance)
```
The summary statistics of the attendance rates based on participation in extracurricular activities show no significant differences. We will now use ANOVA to test for differences in attendance rates based on participation in extracurricular activities. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by extracurricular activities
par(mfrow = c(1, 2))
hist(participate_extracurricular_attendance, main = "Extracurricular Activities", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(do_not_participate_extracurricular_attendance, main = "No Extracurricular Activities", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(participate_extracurricular_attendance)
shapiro.test(do_not_participate_extracurricular_attendance)
```

Both histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on participation in extracurricular activities.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Extracurricular_Activities, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on participation in extracurricular activities, with a p-value greater than 0.05. This indicates that participation in extracurricular activities does not have a significant impact on attendance rates.

## Attendance Rates by Motivational Level

Next, we explore attendance rates based on motivational levels.

```{r}
# Sample the data
high_motivation_attendance <- student_data$Attendance[student_data$Motivation_Level == "High"][sample(sum(student_data$Motivation_Level == "High"), round(sum(student_data$Motivation_Level == "High")*sample_fraction))]
medium_motivation_attendance <- student_data$Attendance[student_data$Motivation_Level == "Medium"][sample(sum(student_data$Motivation_Level == "Medium"), round(sum(student_data$Motivation_Level == "Medium")*sample_fraction))]
low_motivation_attendance <- student_data$Attendance[student_data$Motivation_Level == "Low"][sample(sum(student_data$Motivation_Level == "Low"), round(sum(student_data$Motivation_Level == "Low")*sample_fraction))]

# Summary statistics for attendance rates by motivational levels
summary(high_motivation_attendance)
summary(medium_motivation_attendance)
summary(low_motivation_attendance)
```

The summary statistics of the attendance rates based on motivational levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on motivational levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by motivational levels
par(mfrow = c(1, 3))
hist(high_motivation_attendance, main = "High Motivation Level", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(medium_motivation_attendance, main = "Medium Motivation Level", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(low_motivation_attendance, main = "Low Motivation Level", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_motivation_attendance)
shapiro.test(medium_motivation_attendance)
shapiro.test(low_motivation_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on motivational levels.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Motivation_Level, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on motivational levels, with a p-value greater than 0.05. This indicates that motivation levels do not have a significant impact on attendance rates.

## Attendance Rates by Internet Access

Next, we explore attendance rates based on internet access.

```{r}
# Sample the data
internet_access_attendance <- student_data$Attendance[student_data$Internet_Access == "Yes"][sample(sum(student_data$Internet_Access == "Yes"), round(sum(student_data$Internet_Access == "Yes")*sample_fraction))]
no_internet_access_attendance <- student_data$Attendance[student_data$Internet_Access == "No"][sample(sum(student_data$Internet_Access == "No"), round(sum(student_data$Internet_Access == "No")*sample_fraction))]

# Summary statistics for attendance rates by internet access
summary(internet_access_attendance)
summary(no_internet_access_attendance)
```

The summary statistics of the attendance rates based on internet access show no significant differences. We will now use t-test to test for differences in attendance rates based on internet access. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of attendance rates by internet access
par(mfrow = c(1, 2))
hist(internet_access_attendance, main = "Internet Access", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(no_internet_access_attendance, main = "No Internet Access", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(internet_access_attendance)
shapiro.test(no_internet_access_attendance)
```

Both histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Wilcoxon rank sum test to test for differences in attendance rates based on internet access.

```{r}
# Wilcoxon rank sum test
wilcox.test(internet_access_attendance, no_internet_access_attendance)
```

The Wilcoxon rank sum test shows that there is no significant difference in the average attendance rates based on internet access, with a p-value greater than 0.05. This indicates that internet access does not have a significant impact on attendance rates.

## Attendance Rates by Family Income Category

Next, we explore attendance rates based on family income levels.

```{r}
# Sample the data
low_family_income_attendance <- student_data$Attendance[student_data$Family_Income == "Low"][sample(sum(student_data$Family_Income == "Low"), round(sum(student_data$Family_Income == "Low")*sample_fraction))]
medium_family_income_attendance <- student_data$Attendance[student_data$Family_Income == "Medium"][sample(sum(student_data$Family_Income == "Medium"), round(sum(student_data$Family_Income == "Medium")*sample_fraction))]
high_family_income_attendance <- student_data$Attendance[student_data$Family_Income == "High"][sample(sum(student_data$Family_Income == "High"), round(sum(student_data$Family_Income == "High")*sample_fraction))]

# Summary statistics for attendance rates by family income
summary(high_family_income_attendance)
summary(medium_family_income_attendance)
summary(low_family_income_attendance)
```

The summary statistics of the attendance rates based on family income levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on family income levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by family income
par(mfrow = c(1, 3))
hist(low_family_income_attendance, main = "Low Family Income", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(medium_family_income_attendance, main = "Medium Family Income", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(high_family_income_attendance, main = "High Family Income", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(low_family_income_attendance)
shapiro.test(medium_family_income_attendance)
shapiro.test(high_family_income_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on family income levels.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Family_Income, data = student_data)
```

The Kruksal-Wallis test shows that there is no significant difference in the average attendance rates based on family income levels, with a p-value greater than 0.05. This indicates that family income does not have a significant impact on attendance rates.

## Attendance Rates by Teacher Quality Category

Next, we explore attendance rates based on teacher quality levels.

```{r}
# Sample the data
low_teacher_quality_attendance <- student_data$Attendance[student_data$Teacher_Quality == "Low"][sample(sum(student_data$Teacher_Quality == "Low"), round(sum(student_data$Teacher_Quality == "Low")*sample_fraction))]
medium_teacher_quality_attendance <- student_data$Attendance[student_data$Teacher_Quality == "Medium"][sample(sum(student_data$Teacher_Quality == "Medium"), round(sum(student_data$Teacher_Quality == "Medium")*sample_fraction))]
high_teacher_quality_attendance <- student_data$Attendance[student_data$Teacher_Quality == "High"][sample(sum(student_data$Teacher_Quality == "High"), round(sum(student_data$Teacher_Quality == "High")*sample_fraction))]

# Summary statistics for attendance rates by teacher quality
summary(low_teacher_quality_attendance)
summary(medium_teacher_quality_attendance)
summary(high_teacher_quality_attendance)
```

The summary statistics of the attendance rates based on teacher quality levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on teacher quality levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by teacher quality
par(mfrow = c(1, 3))
hist(low_teacher_quality_attendance, main = "Low Teacher Quality", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(medium_teacher_quality_attendance, main = "Medium Teacher Quality", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(high_teacher_quality_attendance, main = "High Teacher Quality", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(low_teacher_quality_attendance)
shapiro.test(medium_teacher_quality_attendance)
shapiro.test(high_teacher_quality_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on teacher quality levels.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Teacher_Quality, data = student_data)
```

The Kruksal-Wallis test shows that there is no significant difference in the average attendance rates based on teacher quality levels, with a p-value greater than 0.05. This indicates that teacher quality does not have a significant impact on attendance rates.

## Attendance Rates by School Type Category

Next, we explore attendance rates based on school type.

```{r}
# Sample the data
public_school_attendance <- student_data$Attendance[student_data$School_Type == "Public"][sample(sum(student_data$School_Type == "Public"), round(sum(student_data$School_Type == "Public")*sample_fraction))]
private_school_attendance <- student_data$Attendance[student_data$School_Type == "Private"][sample(sum(student_data$School_Type == "Private"), round(sum(student_data$School_Type == "Private")*sample_fraction))]

# Summary statistics for attendance rates by school type
summary(public_school_attendance)
summary(private_school_attendance)
```

The summary statistics of the attendance rates based on school type show no significant differences. We will now use t-test to test for differences in attendance rates based on school type. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of attendance rates by school type
par(mfrow = c(1, 2))
hist(public_school_attendance, main = "Public School", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(private_school_attendance, main = "Private School", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(public_school_attendance)
shapiro.test(private_school_attendance)
```

Both histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Wilcoxon rank sum test to test for differences in attendance rates based on school type.

```{r}
# Wilcoxon rank sum test
wilcox.test(public_school_attendance, private_school_attendance)
```

The Wilcoxon rank sum test shows that there is no significant difference in the average attendance rates based on school type, with a p-value greater than 0.05. This indicates that school type does not have a significant impact on attendance rates.

## Attendance Rates by Peer Influence Category

Next, we explore attendance rates based on peer influence levels.

```{r}
# Sample the data
positive_peer_influence_attendance <- student_data$Attendance[student_data$Peer_Influence == "Positive"][sample(sum(student_data$Peer_Influence == "Positive"), round(sum(student_data$Peer_Influence == "Positive")*sample_fraction))]
negative_peer_influence_attendance <- student_data$Attendance[student_data$Peer_Influence == "Negative"][sample(sum(student_data$Peer_Influence == "Negative"), round(sum(student_data$Peer_Influence == "Negative")*sample_fraction))]
neutral_peer_influence_attendance <- student_data$Attendance[student_data$Peer_Influence == "Neutral"][sample(sum(student_data$Peer_Influence == "Neutral"), round(sum(student_data$Peer_Influence == "Neutral")*sample_fraction))]

# Summary statistics for attendance rates by peer influence
summary(positive_peer_influence_attendance)
summary(negative_peer_influence_attendance)
summary(neutral_peer_influence_attendance)
```

The summary statistics of the attendance rates based on peer influence levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on peer influence levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by peer influence
par(mfrow = c(1, 3))
hist(positive_peer_influence_attendance, main = "Positive Peer Influence", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(negative_peer_influence_attendance, main = "Negative Peer Influence", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(neutral_peer_influence_attendance, main = "Neutral Peer Influence", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(positive_peer_influence_attendance)
shapiro.test(negative_peer_influence_attendance)
shapiro.test(neutral_peer_influence_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on peer influence levels.

```{r}
# Kruksal-Wallis test
kruskal.test(Attendance ~ Peer_Influence, data = student_data)
```

The Kruksal-Wallis test shows that there is no significant difference in the average attendance rates based on peer influence levels, with a p-value greater than 0.05. This indicates that peer influence does not have a significant impact on attendance rates.

## Attendance Rates by Learning Disability Category

Next, we explore attendance rates based on learning disability.

```{r}
# Sample the data
learning_disabilities_attendance <- student_data$Attendance[student_data$Learning_Disabilities == "Yes"][sample(sum(student_data$Learning_Disabilities == "Yes"), round(sum(student_data$Learning_Disabilities == "Yes")*sample_fraction))]
no_learning_disabilities_attendance <- student_data$Attendance[student_data$Learning_Disabilities == "No"][sample(sum(student_data$Learning_Disabilities == "No"), round(sum(student_data$Learning_Disabilities == "No")*sample_fraction))]

# Summary statistics for attendance rates by learning disability
summary(learning_disabilities_attendance)
summary(no_learning_disabilities_attendance)
```

The summary statistics of the attendance rates based on learning disability show no significant differences. We will now use t-test to test for differences in attendance rates based on learning disability. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of attendance rates by learning disability
par(mfrow = c(1, 2))
hist(learning_disabilities_attendance, main = "Learning Disabilities", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(no_learning_disabilities_attendance, main = "No Learning Disabilities", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of t-test
shapiro.test(learning_disabilities_attendance)
shapiro.test(no_learning_disabilities_attendance)
```

Both histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Wilcoxon rank sum test to test for differences in attendance rates based on learning disability.

```{r}
# Wilcoxon rank sum test
wilcox.test(learning_disabilities_attendance, no_learning_disabilities_attendance)
```

The Wilcoxon rank sum test shows that there is no significant difference in the average attendance rates based on learning disability, with a p-value greater than 0.05. This indicates that learning disabilities do not have a significant impact on attendance rates.

## Attendance Rates by Parental Education Level Category

Next, we explore attendance rates based on parental education levels.

```{r}
# Sample the data
high_school_education_attendance <- student_data$Attendance[student_data$Parental_Education_Level == "High School"][sample(sum(student_data$Parental_Education_Level == "High School"), round(sum(student_data$Parental_Education_Level == "High School")*sample_fraction))]
college_education_attendance <- student_data$Attendance[student_data$Parental_Education_Level == "College"][sample(sum(student_data$Parental_Education_Level == "College"), round(sum(student_data$Parental_Education_Level == "College")*sample_fraction))]
postgraduate_education_attendance <- student_data$Attendance[student_data$Parental_Education_Level == "Postgraduate"][sample(sum(student_data$Parental_Education_Level == "Postgraduate"), round(sum(student_data$Parental_Education_Level == "Postgraduate")*sample_fraction))]

# Summary statistics for attendance rates by parental education level
summary(high_school_education_attendance)
summary(college_education_attendance)
summary(postgraduate_education_attendance)
```

The summary statistics of the attendance rates based on parental education levels show no significant differences. We will now use ANOVA to test for differences in attendance rates based on parental education levels. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by parental education level
par(mfrow = c(1, 3))
hist(high_school_education_attendance, main = "High School Education", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(college_education_attendance, main = "College Education", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(postgraduate_education_attendance, main = "Postgraduate Education", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(high_school_education_attendance)
shapiro.test(college_education_attendance)
shapiro.test(postgraduate_education_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on parental education levels.


```{r}
# Kruskal-Wallis test
kruskal.test(Attendance ~ Parental_Education_Level, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on parental education levels, with a p-value greater than 0.05. This indicates that parental education levels do not have a significant impact on attendance rates.

## Attendance Rates by Distance from Home Category

Next, we explore attendance rates based on distance from home to school.

```{r}
# Sample the data
near_distance_attendance <- student_data$Attendance[student_data$Distance_from_Home == "Near"][sample(sum(student_data$Distance_from_Home == "Near"), round(sum(student_data$Distance_from_Home == "Near")*sample_fraction))]
moderate_distance_attendance <- student_data$Attendance[student_data$Distance_from_Home == "Moderate"][sample(sum(student_data$Distance_from_Home == "Moderate"), round(sum(student_data$Distance_from_Home == "Moderate")*sample_fraction))]
far_distance_attendance <- student_data$Attendance[student_data$Distance_from_Home == "Far"][sample(sum(student_data$Distance_from_Home == "Far"), round(sum(student_data$Distance_from_Home == "Far")*sample_fraction))]

# Summary statistics for attendance rates by distance from home
summary(near_distance_attendance)
summary(moderate_distance_attendance)
summary(far_distance_attendance)
```

The summary statistics of the attendance rates based on distance from home to school show no significant differences. We will now use ANOVA to test for differences in attendance rates based on the distance from home to school. But first, we need to check the assumptions of ANOVA.

```{r}
# Histogram of attendance rates by distance from home
par(mfrow = c(1, 3))
hist(near_distance_attendance, main = "Near Distance from Home", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(moderate_distance_attendance, main = "Moderate Distance from Home", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(far_distance_attendance, main = "Far Distance from Home", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(near_distance_attendance)
shapiro.test(moderate_distance_attendance)
shapiro.test(far_distance_attendance)
```

All three histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for all students. We will now use Kruksal-Wallis test to test for differences in attendance rates based on distance from home.

```{r}
# Kruskal-Wallis test
kruskal.test(Attendance ~ Distance_from_Home, data = student_data)
```

The Kruskal-Wallis test shows that there is no significant difference in the average attendance rates based on the distance from home to school, with a p-value greater than 0.05. This indicates that the distance from home to school does not have a significant impact on attendance rates.

## Attendance Rates by Gender Category

Finally, we explore attendance rates based on gender.

```{r}
# Sample the data
male_attendance <- student_data$Attendance[student_data$Gender == "Male"][sample(sum(student_data$Gender == "Male"), round(sum(student_data$Gender == "Male")*sample_fraction))]
female_attendance <- student_data$Attendance[student_data$Gender == "Female"][sample(sum(student_data$Gender == "Female"), round(sum(student_data$Gender == "Female")*sample_fraction))]

# Summary statistics for attendance rates by gender
summary(male_attendance)
summary(female_attendance)
```

The summary statistics of the attendance rates based on gender show no significant differences. We will now use t-test to test for differences in attendance rates based on internet access. But first, we need to check the assumptions of t-test.

```{r}
# Histogram of attendance rates by gender
par(mfrow = c(1, 2))
hist(male_attendance, main = "Male", xlab = "Attendance Rate", col = "skyblue", border = "black")
hist(female_attendance, main = "Female", xlab = "Attendance Rate", col = "skyblue", border = "black")

# Check assumptions of ANOVA
shapiro.test(male_attendance)
shapiro.test(female_attendance)
```

Both histograms and the Shapiro-Wilk test show that the distribution of attendance rates is not normal for both genders. We will now use Wilcoxon rank sum test to test for differences in attendance rates based on gender.

```{r}
# Wilcoxon rank sum test
wilcox.test(male_attendance, female_attendance)
```

The Wilcoxon rank sum test shows that there is no significant difference in the average attendance rates based on gender, with a p-value greater than 0.05. This indicates that gender does not have a significant impact on attendance rates.

## Summary of Attendance Rates

In summary, we have explored the variation in attendance rates across students based on various factors such as parental involvement, access to resources, extracurricular activities, motivational levels, internet access, family income, teacher quality, school type, peer influence, learning disabilities, parental education levels, distance from home to school, and gender. From our analysis we found that none of the factors showed significant differences in attendance rates. This suggests that attendance rates are evenly distributed across students and are not significantly influenced by the factors we examined.

# The distribution of parental involvement levels among students

Now we analyze the distribution of parental involvement levels among students.

```{r}
# Count of parental involvement levels
table(student_data$Parental_Involvement)

# Bar plot of parental involvement levels
barplot(table(student_data$Parental_Involvement), main = "Distribution of Parental Involvement Levels", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
```

The distribution of parental involvement levels among students is as follows:

- **High**: 1836 students
- **Low**: 1290 students
- **Medium**: 3251 students

We can see that the majority of students have medium parental involvement levels, followed by high parental involvement levels, and low parental involvement levels.

## The distribution of parental involvement levels among students by Family Income Category

We now explore the distribution of parental involvement levels among students based on family income levels.

```{r}
# Count of parental involvement levels by family income
table(student_data$Parental_Involvement, student_data$Family_Income)

# Bar plot of parental involvement levels by family income
par(mfrow = c(1, 3))
barplot(table(student_data$Parental_Involvement[student_data$Family_Income == "Low"]), main = "Low Family Income", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Parental_Involvement[student_data$Family_Income == "Medium"]), main = "Medium Family Income", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Parental_Involvement[student_data$Family_Income == "High"]), main = "High Family Income", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
```

- The `Low Family Income` group has the highest counts across all levels of parental involvement, suggesting that more students in the dataset come from low-income families.
- Students with Medium Parental Involvement and Medium Family Income form the largest single group (1332 students).
- Students with Low Parental Involvement and High Family Income form the smallest single group (240 students).

## The distribution of parental involvement levels among students by Parental Education Level Category

We now explore the distribution of parental involvement levels among students based on parental education levels.

```{r}
# Count of parental involvement levels by parental education level
table(student_data$Parental_Involvement, student_data$Parental_Education_Level)

# Bar plot of parental involvement levels by parental education level
par(mfrow = c(1, 3))
barplot(table(student_data$Parental_Involvement[student_data$Parental_Education_Level == "High School"]), main = "High School Education", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Parental_Involvement[student_data$Parental_Education_Level == "College"]), main = "College Education", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Parental_Involvement[student_data$Parental_Education_Level == "Postgraduate"]), main = "Postgraduate Education", xlab = "Parental Involvement Levels", ylab = "Frequency", col = "skyblue", border = "black")
```

- **High School Education**: The largest counts across all levels of Parental Involvement are observed in families where the parental education level is "High School."
For example, the highest count is for Medium Parental Involvement with parents educated at the high school level (1634 students).
- **Postgraduate Education**: The smallest counts are generally in families where the parental education level is "Postgraduate," suggesting that fewer students' parents fall into this category.
For example, only 265 students with Low Parental Involvement have parents with postgraduate education.
- **College Education**: Counts are intermediate, with Medium Parental Involvement having the highest representation (960 students).

# The proportion of students with access to educational resources

We now analyze the proportion of students with access to educational resources.

```{r}
# Count of access to resources
table(student_data$Access_to_Resources)

# Bar plot of access to resources
barplot(table(student_data$Access_to_Resources), main = "Distribution of Access to Resources", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
```

High    Low Medium
1900   1274   3203

The distribution of access to resources among students is as follows:

- **High**: 1900 students
- **Low**: 1274 students
- **Medium**: 3203 students

We can see that the majority of students have medium access to educational resources, followed by high access to resources, and low access to resources.

## The proportion of students with access to educational resources by Family Income Category

We now explore the proportion of students with access to educational resources based on family income levels.

```{r}
# Count of access to resources by family income
table(student_data$Access_to_Resources, student_data$Family_Income)

# Bar plot of access to resources by family income
par(mfrow = c(1, 3))
barplot(table(student_data$Access_to_Resources[student_data$Family_Income == "Low"]), main = "Low Family Income", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Access_to_Resources[student_data$Family_Income == "Medium"]), main = "Medium Family Income", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Access_to_Resources[student_data$Family_Income == "High"]), main = "High Family Income", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
```

- **Low Income Families**: Students from Low Income families tend to have the largest counts in Medium Access to Resources (1267 students), suggesting moderate access to resources even for lower-income groups.
- **High Income Families**: Students from High Income families are more likely to have High Access to Resources (369 students) than Low Access to Resources (237 students).
- **Medium Income Families**: Students from Medium Income families dominate the Medium Access to Resources category (1313 students), indicating a balanced availability of resources.

## The proportion of students with access to educational resources by Parental Education Level Category

We now explore the proportion of students with access to educational resources based on parental education levels.

```{r}
# Count of access to resources by parental education level
table(student_data$Access_to_Resources, student_data$Parental_Education_Level)

# Bar plot of access to resources by parental education level
par(mfrow = c(1, 3))
barplot(table(student_data$Access_to_Resources[student_data$Parental_Education_Level == "High School"]), main = "High School Education", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Access_to_Resources[student_data$Parental_Education_Level == "College"]), main = "College Education", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
barplot(table(student_data$Access_to_Resources[student_data$Parental_Education_Level == "Postgraduate"]), main = "Postgraduate Education", xlab = "Access to Resources", ylab = "Frequency", col = "skyblue", border = "black")
```

- **High School Education**: Parents with High School education have the highest counts in all access levels, particularly Medium Access to Resources (1550 students). This suggests that a significant number of students with parents in this category experience moderate access to resources.
- **College Education**: Students whose parents have College education mostly fall into the Medium Access to Resources category (1004 students). A considerable proportion also have High Access to Resources (564 students).
- **Postgraduate Education**: Students with parents who have a Postgraduate education show a higher likelihood of High Access to Resources (373 students) compared to Low Access to Resources (258 students).

# The variation in sleep hours across different levels of extracurricular participation























